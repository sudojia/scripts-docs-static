"use strict";(self.webpackChunkscript_docs=self.webpackChunkscript_docs||[]).push([[5052],{7566:(e,s,c)=>{c.r(s),c.d(s,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>t});var n=c(4848),o=c(8453);const r={title:"Docker \u90e8\u7f72",sidebar_position:1},d=void 0,i={id:"use/docker/index",title:"Docker \u90e8\u7f72",description:"\u6b64 Docker \u90e8\u7f72\u65b9\u5f0f\u53c2\u8003\u4e86 Akira \u548c lxk",source:"@site/docs/use/docker/index.md",sourceDirName:"use/docker",slug:"/use/docker/",permalink:"/docs/use/docker/",draft:!1,unlisted:!1,editUrl:"https://github.com/sudojia/scripts-docs/tree/master/docs/use/docker/index.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Docker \u90e8\u7f72",sidebar_position:1},sidebar:"scripts",previous:{title:"\u4f7f\u7528\u65b9\u5f0f",permalink:"/docs/category/\u4f7f\u7528\u65b9\u5f0f"},next:{title:"\u9752\u9f99\u9762\u677f",permalink:"/docs/use/qinglong/"}},l={},t=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:2},{value:"\u5176\u5b83\u547d\u4ee4",id:"\u5176\u5b83\u547d\u4ee4",level:2}];function a(e){const s={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",del:"del",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.admonition,{type:"info",children:(0,n.jsx)(s.p,{children:"\u6b64 Docker \u90e8\u7f72\u65b9\u5f0f\u53c2\u8003\u4e86 Akira \u548c lxk"})}),"\n",(0,n.jsxs)(s.p,{children:["\u63a8\u8350\u4f7f\u7528 ",(0,n.jsx)(s.code,{children:"docker-compose"})," \u6240\u4ee5\u8fd9\u91cc\u53ea\u4ecb\u7ecd ",(0,n.jsx)(s.code,{children:"docker-compose"})," \u4f7f\u7528\u65b9\u5f0f"]}),"\n",(0,n.jsx)(s.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'sudo curl -L "https://github.com/docker/compose/releases/download/v2.27.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\n'})}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"\u5b89\u88c5\u4e0d\u4e0a\u81ea\u884c\u5bfb\u627e\u53cd\u4ee3\u94fe\u63a5\u8fdb\u884c\u52a0\u901f"})}),"\n"]}),"\n",(0,n.jsx)(s.admonition,{type:"warning",children:(0,n.jsxs)(s.p,{children:["\u7fa4\u6656 Nas Docker \u81ea\u5e26\u5b89\u88c5\u4e86 ",(0,n.jsx)(s.code,{children:"docker-compose"})]})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Ubuntu"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"sudo apt-get update && sudo apt-get install -y python3-pip curl vim git moreutils\npip3 install --upgrade pip\npip install docker-compose\n"})}),"\n",(0,n.jsxs)(s.p,{children:["\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u901a\u8fc7 ",(0,n.jsx)(s.code,{children:"docker-compose version"})," \u67e5\u770b ",(0,n.jsx)(s.code,{children:"docker-compose"})," \u7248\u672c\uff0c\u786e\u8ba4\u662f\u5426\u5b89\u88c5\u6210\u529f\u3002"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{src:"https://pic.rmb.bdstatic.com/bjh/241005/6ca4c3243e74a8d449d3d9ec38c6a4eb2169.png",alt:"images"})}),"\n",(0,n.jsx)(s.h2,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,n.jsxs)(s.p,{children:["\u968f\u610f\uff08\u53ef\u4ee5\u5728 ",(0,n.jsx)(s.code,{children:"home"}),"\uff0c\u53ef\u4ee5\u5728 ",(0,n.jsx)(s.code,{children:"opt"}),"\uff09\u521b\u5efa\u4e00\u4e2a\u76ee\u5f55\u540d\u4e3a ",(0,n.jsx)(s.code,{children:"AutoTaskScript"})," \u6587\u4ef6\u5939\uff0c\u540e\u7eed\u8fc1\u79fb\u91cd\u88c5\u7684\u65f6\u5019\u53ea\u9700\u8981\u5907\u4efd\u6574\u4e2a ",(0,n.jsx)(s.code,{children:"AutoTaskScript"})," \u76ee\u5f55\u5373\u53ef"]}),"\n",(0,n.jsxs)(s.p,{children:["\u5728 ",(0,n.jsx)(s.code,{children:"AutoTaskScript"})," \u4e0b\u65b0\u5efa\u51e0\u4e2a\u5fc5\u987b\u7684\u6587\u4ef6"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"mkdir logs \\\n&& touch my_crontab_list.sh \\\n&& wget -O docker-compose.yml https://raw.githubusercontent.com/sudojia/AutoTaskScript/refs/heads/script/docker/docker-compose.yml\n"})}),"\n",(0,n.jsx)(s.admonition,{type:"warning",children:(0,n.jsx)(s.p,{children:"\u8fd8\u662f\u4e00\u6837\uff0cwget \u5931\u8d25\u81ea\u884c\u5bfb\u627e\u53cd\u4ee3\u94fe\u63a5\u8fdb\u884c\u52a0\u901f\uff0c\u6216\u8005\u4e0b\u8f7d\u5230\u672c\u5730\u518d\u4e0a\u4f20\u5230\u670d\u52a1\u5668"})}),"\n",(0,n.jsx)(s.p,{children:"\u76ee\u5f55\u7ed3\u6784\u53c2\u8003\u5982\u4e0b\uff1a"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-markdown",children:"AutoTaskScript\n\u251c\u2500\u2500 logs # \u5b58\u653e\u65e5\u5fd7\u6587\u4ef6\uff0c\u8bb0\u5f55\u811a\u672c\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u4fe1\u606f\uff0c\u4fbf\u4e8e\u95ee\u9898\u6392\u67e5\u548c\u76d1\u63a7\n\u2502   \u251c\u2500\u2500 XXXX.log      \n\u2502   \u2514\u2500\u2500 XXXX.log\n\u251c\u2500\u2500 my_crontab_list.sh # \u81ea\u5b9a\u4e49\u5b9a\u65f6\u4efb\u52a1\u5217\u8868\n\u2514\u2500\u2500 docker-compose.yml # Docker \u5bb9\u5668\u7f16\u6392\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u5b9a\u4e49\u548c\u8fd0\u884c\u591a\u5bb9\u5668 Docker \u5e94\u7528\u7a0b\u5e8f\n"})}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"docker-compose.yml \u8bf4\u660e"}),"\uff1a"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsxs)(s.del,{children:["\u76ee\u524d\u4e0e ",(0,n.jsx)(s.code,{children:"lxk"})," \u4f6c\u4e0d\u540c\u5728\u4e8e\uff0c\u4f7f\u7528\u7684\u662f\u81ea\u5b9a\u4e49\u4efb\u52a1\u5e76\u4e14",(0,n.jsx)(s.strong,{children:"\u8986\u76d6\u9ed8\u8ba4\u4efb\u52a1"}),"\uff08\u56e0\u4e3a\u6211\u61d2\uff0c\u771f\u4e0d\u60f3\u4e00\u4e2a\u4e00\u4e2a\u52a0\uff09"]})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsxs)(s.del,{children:["\u60f3\u8dd1\u54ea\u4e2a\u811a\u672c\u81ea\u884c\u5728 ",(0,n.jsx)(s.code,{children:"my_crontab_list.sh"})," \u52a0\u8fdb\u53bb\u5c31\u597d\u4e86"]})}),"\n",(0,n.jsxs)(s.admonition,{type:"info",children:[(0,n.jsxs)(s.p,{children:["2024/10/8 \u4f18\u5316\u66f4\u65b0\uff1a\u76ee\u524d\u5df2\u5199\u4e86\u81ea\u52a8\u751f\u6210\u5b9a\u65f6\u4efb\u52a1\uff0c\u65e0\u9700\u81ea\u5df1\u4e00\u4e2a\u4e00\u4e2a\u6dfb\u52a0\u8981\u8dd1\u7684\u811a\u672c ",(0,n.jsx)(s.a,{href:"https://github.com/sudojia/AutoTaskScript/blob/247bc9b562ea8656aaa3726e4b562126200ae9ad/docker/default_task.sh#L13",children:"[default_task.sh#13]"})]}),(0,n.jsxs)(s.p,{children:["\u5982\u679c\u6709\u4e0d\u60f3\u8dd1\u7684\u811a\u672c\u5728 ",(0,n.jsx)(s.code,{children:"DO_NOT_RUN_SCRIPTS"})," \u914d\u7f6e\u9879\u914d\u7f6e\u5373\u53ef\uff0c\u591a\u4e2a\u811a\u672c\u7528 ",(0,n.jsx)(s.code,{children:"&"})," \u5206\u9694"]}),(0,n.jsxs)(s.p,{children:["\u4f8b\u5982\uff1a",(0,n.jsx)(s.code,{children:"sudojia_starMom.js&sudojia_tilta.js"})]})]}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsxs)(s.del,{children:[(0,n.jsx)(s.strong,{children:"my_crontab_list.sh \u53c2\u8003\u5982\u4e0b"}),"\uff1a"]})," \u8fd9\u4e2a\u4e0d\u7528\u770b\u4e86\uff0c\u521b\u5efa\u4e2a\u7a7a\u6587\u4ef6\u5373\u53ef"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-sh",children:"# \u6bcf\u9694 3 \u5929 23:50 \u6e05\u7406\u4e00\u6b21\u65e5\u5fd7\n50 23 */3 * * rm -rf /AutoTaskScript/src/logs/*.log\n\n# \u4ee5\u4e0b\u53ea\u662f\u793a\u4f8b\uff0c\u81ea\u884c\u5220\u9664\u6dfb\u52a0\n##############\u5c0f\u7a0b\u5e8f##############\n# \u9738\u738b\u8336\u59ec\n22 11 * * * node /AutoTaskScript/src/wx_mini/sudojia_bwtea.js >> /AutoTaskScript/src/logs/sudojia_bwtea.log 2>&1\n\n##############\u5ba2\u6237\u7aef##############\n# \u591a\u5a07\u6c5f\u5c71\n14 7 * * * node /AutoTaskScript/src/client/sudojia_jiangshan.js >> /AutoTaskScript/src/logs/sudojia_jiangshan.log 2>&1\n\n##############\u7f51\u9875\u7aef##############\n# v2ex\n0 9 * * * node /AutoTaskScript/src/web/sudojia_v2ex.js >> /AutoTaskScript/src/logs/sudojia_v2ex.log 2>&1\n\n##############\u516c\u4f17\u53f7##############\n# \u6c34\u8d39\u6613\n3 9 * * * node /AutoTaskScript/src/public/sudojia_shuifei.js >> /AutoTaskScript/src/logs/sudojia_shuifei.log 2>&1\n"})}),"\n",(0,n.jsxs)(s.p,{children:["\u914d\u7f6e\u597d\u76ee\u5f55\u53ca ",(0,n.jsx)(s.code,{children:"docker-compose.yml"})," \u4e4b\u540e\u6267\u884c\u5982\u4e0b\u547d\u4ee4"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-sh",children:"docker-compose up -d\n"})}),"\n",(0,n.jsxs)(s.p,{children:["\u540e\u7eed\u53ea\u8981\u4fee\u6539 ",(0,n.jsx)(s.code,{children:"docker-compose.yml"})," \u90fd\u9700\u8981\u4f7f\u7528\u6b64\u547d\u4ee4\u4f7f\u5176\u66f4\u6539\u751f\u6548"]}),"\n",(0,n.jsx)(s.p,{children:"\u5230\u8fd9\u5c31\u5df2\u7ecf\u914d\u7f6e\u5b8c\u6bd5\u4e86\uff01"}),"\n",(0,n.jsx)(s.h2,{id:"\u5176\u5b83\u547d\u4ee4",children:"\u5176\u5b83\u547d\u4ee4"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"docker-compose logs"})," \u6253\u5370\u65e5\u5fd7"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"docker-compose pull"})," \u66f4\u65b0\u955c\u50cf"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"docker-compose stop"})," \u505c\u6b62\u5bb9\u5668"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"docker-compose restart"})," \u91cd\u542f\u5bb9\u5668"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"docker-compose down"})," \u505c\u6b62\u5e76\u5220\u9664\u5bb9\u5668"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"docker exec -it [CONTAINER ID] sh"})," \u8fdb\u5165\u5bb9\u5668\u5185\u90e8"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"docker exec -it [CONTAINER ID] sh /AutoTaskScript/docker/docker_entrypoint.sh"})," \u624b\u52a8\u66f4\u65b0\u811a\u672c\u4ed3\u5e93"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"docker exec -it [CONTAINER ID] crontab -l"})," \u67e5\u770b\u751f\u6548\u7684\u5b9a\u65f6\u4efb\u52a1"]}),"\n"]}),"\n",(0,n.jsxs)(s.p,{children:["\u540e\u9762\u53ea\u8981\u6709\u811a\u672c\u8fd0\u884c\uff0c\u5c31\u53ef\u4ee5\u5728 ",(0,n.jsx)(s.code,{children:"logs"})," \u91cc\u67e5\u770b\u811a\u672c\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u4fe1\u606f"]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{src:"https://pic.rmb.bdstatic.com/bjh/241005/5438d5a47ddd6d1b35f8827fadd9480c2186.png",alt:"images"})}),"\n",(0,n.jsx)(s.p,{children:"\u4f60\u4e5f\u53ef\u4ee5\u8fdb\u5165\u5bb9\u5668\u5185\u90e8\u624b\u52a8\u6267\u884c\u811a\u672c\u770b\u4e0b\u662f\u5426\u6b63\u5e38\uff1a"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-sh",children:"docker exec -it [CONTAINER ID] sh  # \u8fdb\u5165\u5bb9\u5668\u5185\u90e8, CONTAINER ID: \u5bb9\u5668 id\uff0c\u901a\u8fc7 docker ps \u67e5\u770b\n"})}),"\n",(0,n.jsx)(s.p,{children:"\u8fd0\u884c\u67d0\u4e2a\u811a\u672c\uff1a"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"node /AutoTaskScript/src/wx_mini/sudojia_bwtea.js | tee -a /AutoTaskScript/src/logs/sudojia_bwtea.log\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{src:"https://pic.rmb.bdstatic.com/bjh/241005/d5a1a813353ee0f259e38315d1966b821130.png",alt:"images"})}),"\n",(0,n.jsx)(s.p,{children:"\u67e5\u770b\u751f\u6548\u7684\u5b9a\u65f6\u4efb\u52a1"}),"\n",(0,n.jsx)(s.p,{children:"\u5bbf\u4e3b\u673a\u5185\uff1a"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"docker exec -it [CONTAINER ID] crontab -l\n"})}),"\n",(0,n.jsx)(s.p,{children:"\u5bb9\u5668\u5185\uff1a"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-shell",children:"crontab -l\n"})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{src:"https://pic.rmb.bdstatic.com/bjh/241008/44c638fdcb82754d168c13b256a3cd706612.png",alt:"image"})}),"\n",(0,n.jsxs)(s.p,{children:["\u8fd8\u6709\u4e0d\u61c2\u7684 ",(0,n.jsx)(s.a,{href:"https://t.me/v_script",children:"#\u8fdb\u7fa4\u4ea4\u6d41"})]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},8453:(e,s,c)=>{c.d(s,{R:()=>d,x:()=>i});var n=c(6540);const o={},r=n.createContext(o);function d(e){const s=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);